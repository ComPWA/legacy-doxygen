<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ComPWA: /home/travis/build/ComPWA/ComPWA/ThirdParty/tbb/examples/graph/som/som_graph.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
<link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="doxy-boot.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ComPWA
   </div>
   <div id="projectbrief">Common Partial-Wave-Analysis Framework</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ca6cabe6faa89642a99ddef30fe3d137.html">ThirdParty</a></li><li class="navelem"><a class="el" href="dir_4ee327cceb5ec3d1099799d35924c881.html">tbb</a></li><li class="navelem"><a class="el" href="dir_9120db56d5c6e3d0054de45954f4726d.html">examples</a></li><li class="navelem"><a class="el" href="dir_5b9f198f80a581835be4f52933bd75ca.html">graph</a></li><li class="navelem"><a class="el" href="dir_8d356b09a5f84ee5a120bdbda19f17d5.html">som</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">som_graph.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="som__graph_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">    Copyright (c) 2005-2018 Intel Corporation</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">    Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">    you may not use this file except in compliance with the License.</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">    You may obtain a copy of the License at</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">        http://www.apache.org/licenses/LICENSE-2.0</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">    Unless required by applicable law or agreed to in writing, software</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">    distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">    See the License for the specific language governing permissions and</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">    limitations under the License.</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// Self-organizing map in TBB flow::graph</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//   This is an example of the use of cancellation in a graph.  After a point in searching for</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//   the best match for an example, two examples are looked for simultaneously.  When the</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//   earlier example is found and the update radius is determined, the affected searches</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">//   for the subsequent example are cancelled, and after the update they are restarted.</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">//   As the update radius shrinks fewer searches are cancelled, and by the last iterations</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">//   virtually all the work done for the speculating example is useful.</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// first, a simple implementation with only one example vector</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// at a time.</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">// we will do a color map (the simple example.)</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">//  graph algorithm</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">//       for some number of iterations</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">//           update radius r, weight of change L </span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">//           for each example V</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">//               use graph to find BMU</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">//               for each part of map within radius of BMU W</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">//                   update vector:  W(t+1) = W(t) + w(dist)*L*(V - W(t))</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#a8f98cb6e8a97d210b7a5151fbe0476f2">   45</a></span>&#160;<span class="preprocessor">#define _MAIN_C_ 1</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="som_8h.html">som.h</a>&quot;</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="task__scheduler__init_8h.html">tbb/task_scheduler_init.h</a>&quot;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="flow__graph_8h.html">tbb/flow_graph.h</a>&quot;</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="blocked__range2d_8h.html">tbb/blocked_range2d.h</a>&quot;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="tick__count_8h.html">tbb/tick_count.h</a>&quot;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;../../common/utility/utility.h&quot;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#a8d23feea868a983c8c2b661e1e16972f">   54</a></span>&#160;<span class="preprocessor">#define RED 0</span></div><div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#acfbc006ea433ad708fdee3e82996e721">   55</a></span>&#160;<span class="preprocessor">#define GREEN 1</span></div><div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#a79d10e672abb49ad63eeaa8aaef57c38">   56</a></span>&#160;<span class="preprocessor">#define BLUE 2</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#a32af869bbcd0ede2149253f2db7bd0be">   58</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="som__graph_8cpp.html#a32af869bbcd0ede2149253f2db7bd0be">xranges</a> = 1;</div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#a3de923087d7d6385616dfc3582306007">   59</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="som__graph_8cpp.html#a3de923087d7d6385616dfc3582306007">yranges</a> = 1;</div><div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#ae493181272fa9ab0f26074f3d55fa27a">   60</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="som__graph_8cpp.html#ae493181272fa9ab0f26074f3d55fa27a">xsize</a> = -1;</div><div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#ac70272affec5182515dd40abe4c39f80">   61</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="som__graph_8cpp.html#ac70272affec5182515dd40abe4c39f80">ysize</a> = -1;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#ab2687047943e58dbb6df86106a2659e8">   63</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="som__graph_8cpp.html#ab2687047943e58dbb6df86106a2659e8">global_i</a> = 0;</div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#aa818eee885a2527c70ff82b2ef23e3e4">   64</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="som__graph_8cpp.html#aa818eee885a2527c70ff82b2ef23e3e4">speculation_start</a>; </div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#a40d65054c8b42f7adf2389202f03d77d">   65</a></span>&#160;std::vector&lt;int&gt; <a class="code" href="som__graph_8cpp.html#a40d65054c8b42f7adf2389202f03d77d">function_node_execs</a>;</div><div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#a1055305a3f037f731953b55723e1b12e">   66</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="som__graph_8cpp.html#a1055305a3f037f731953b55723e1b12e">xRangeMax</a> = 3;</div><div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#af1faccf35e9005eed4d1259fb2ae3f1b">   67</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="som__graph_8cpp.html#af1faccf35e9005eed4d1259fb2ae3f1b">yRangeMax</a> = 3;</div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#a4249b3ebda4de972d24aa1d6d940736f">   68</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="som__graph_8cpp.html#a4249b3ebda4de972d24aa1d6d940736f">dont_speculate</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#a1f78f8cac44d71bb1f9e980bc2ddc65d">   69</a></span>&#160;<span class="keyword">static</span> <a class="code" href="som_8h.html#a16eb97d90e5683b87599279f1c47db48">search_result_type</a> <a class="code" href="som__graph_8cpp.html#a1f78f8cac44d71bb1f9e980bc2ddc65d">last_update</a>;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="classBMU__search__body.html">   71</a></span>&#160;<span class="keyword">class </span><a class="code" href="classBMU__search__body.html">BMU_search_body</a> {</div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="classBMU__search__body.html#a5da4722243abfedf13f203f21df65997">   72</a></span>&#160;    <a class="code" href="classSOMap.html">SOMap</a> &amp;<a class="code" href="classBMU__search__body.html#a5da4722243abfedf13f203f21df65997">my_map</a>;</div><div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="classBMU__search__body.html#a0ab4ecd76ceb24fcdd45e0a00b4536cc">   73</a></span>&#160;    <a class="code" href="classtbb_1_1blocked__range2d.html">subsquare_type</a> <a class="code" href="classBMU__search__body.html#a0ab4ecd76ceb24fcdd45e0a00b4536cc">my_square</a>;</div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="classBMU__search__body.html#aae6cb55a00bf061724f7fec1649792d7">   74</a></span>&#160;    <span class="keywordtype">int</span> &amp;<a class="code" href="classBMU__search__body.html#aae6cb55a00bf061724f7fec1649792d7">fn_tally</a>;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="classBMU__search__body.html#a86d3a2fb1dd09da01f729f773c43f3ae">   76</a></span>&#160;    <a class="code" href="classBMU__search__body.html#a86d3a2fb1dd09da01f729f773c43f3ae">BMU_search_body</a>(<a class="code" href="classSOMap.html">SOMap</a> &amp;_m, <a class="code" href="classtbb_1_1blocked__range2d.html">subsquare_type</a> &amp;_sq, <span class="keywordtype">int</span> &amp;fnt) : my_map(_m), my_square(_sq), fn_tally(fnt) { }</div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="classBMU__search__body.html#a75c91e1aa519083c5fa3c8f888cffbbd">   77</a></span>&#160;    <a class="code" href="classBMU__search__body.html#a75c91e1aa519083c5fa3c8f888cffbbd">BMU_search_body</a>( <span class="keyword">const</span> <a class="code" href="classBMU__search__body.html">BMU_search_body</a> &amp;<a class="code" href="namespaceEvtCyclic3.html#af4cab885a5c1f8f7fadbe90eaf9964a4">other</a>) : my_map(other.my_map), my_square(other.my_square), fn_tally(other.fn_tally) { }</div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="classBMU__search__body.html#a6e20a53a9bd3eeece9a07c48c6736a60">   78</a></span>&#160;    <a class="code" href="som_8h.html#a16eb97d90e5683b87599279f1c47db48">search_result_type</a> <a class="code" href="classBMU__search__body.html#a6e20a53a9bd3eeece9a07c48c6736a60">operator()</a>(<span class="keyword">const</span> <a class="code" href="classSOM__element.html">SOM_element</a> <a class="code" href="ittnotify__static_8h.html#a571c9802609300b38fd3d5ac52b1773c">s</a>) {</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordtype">int</span> my_x;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordtype">int</span> my_y;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordtype">double</span> min_dist = my_map.<a class="code" href="classSOMap.html#a541406964c0a17c8ae3d6e13457a524d">BMU_range</a>(s, my_x, my_y, my_square);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        ++<a class="code" href="classBMU__search__body.html#aae6cb55a00bf061724f7fec1649792d7">fn_tally</a>;  <span class="comment">// count how many times this function_node executed</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="som_8h.html#a16eb97d90e5683b87599279f1c47db48">search_result_type</a>(min_dist, my_x, my_y);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    }</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;};</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#a9fd160e78600bbd232c1f19085cd3c39">   87</a></span>&#160;<span class="keyword">typedef</span> function_node&lt;SOM_element, search_result_type&gt; <a class="code" href="som__graph_8cpp.html#a9fd160e78600bbd232c1f19085cd3c39">search_node</a>;</div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#a02484ba0b62481bba766aeefbb717520">   88</a></span>&#160;<span class="keyword">typedef</span> broadcast_node&lt;SOM_element&gt; <a class="code" href="som__graph_8cpp.html#a02484ba0b62481bba766aeefbb717520">b_node</a>;</div><div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#a5754e5878c4a4653f2c3313aa0c9fdbe">   89</a></span>&#160;<span class="keyword">typedef</span> std::vector&lt; search_node *&gt; <a class="code" href="som__graph_8cpp.html#a5754e5878c4a4653f2c3313aa0c9fdbe">search_node_vector_type</a>;</div><div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#ac02b98124e6089e89a3bddb09e2cedb6">   90</a></span>&#160;<span class="keyword">typedef</span> std::vector&lt; search_node_vector_type &gt; <a class="code" href="som__graph_8cpp.html#ac02b98124e6089e89a3bddb09e2cedb6">search_node_array_type</a>;</div><div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#a1a5969e9de846424d9d6d02491a5fa32">   91</a></span>&#160;<span class="keyword">typedef</span> std::vector&lt; graph *&gt; <a class="code" href="som__graph_8cpp.html#a1a5969e9de846424d9d6d02491a5fa32">graph_vector_type</a>;</div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#a982a1edf1c14348e55ab93f8f8afa0cb">   92</a></span>&#160;<span class="keyword">typedef</span> std::vector&lt; graph_vector_type &gt; <a class="code" href="som__graph_8cpp.html#a982a1edf1c14348e55ab93f8f8afa0cb">graph_array_type</a>;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#a9fe42dea26d4f9c8da030ad751abe0c3">   94</a></span>&#160;<span class="preprocessor">#define SPECULATION_CNT 2</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#a7ffc60a847109480ec0320f8f4f181fc">   96</a></span>&#160;graph *<a class="code" href="som__graph_8cpp.html#a7ffc60a847109480ec0320f8f4f181fc">g</a>[<a class="code" href="som__graph_8cpp.html#a9fe42dea26d4f9c8da030ad751abe0c3">SPECULATION_CNT</a>];  <span class="comment">// main graph; there should only be one per epoch</span></div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#a749a410cadcbe27cfb4afef68a41a0c7">   97</a></span>&#160;<a class="code" href="som__graph_8cpp.html#a02484ba0b62481bba766aeefbb717520">b_node</a> *<a class="code" href="som__graph_8cpp.html#a749a410cadcbe27cfb4afef68a41a0c7">send_to</a>[<a class="code" href="som__graph_8cpp.html#a9fe42dea26d4f9c8da030ad751abe0c3">SPECULATION_CNT</a>];      <span class="comment">// broadcast node to send exemplar to all function_nodes</span></div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#ae900b2add8deca663438fb20de69acce">   98</a></span>&#160;queue_node&lt;search_result_type&gt; *<a class="code" href="som__graph_8cpp.html#ae900b2add8deca663438fb20de69acce">q</a>[<a class="code" href="som__graph_8cpp.html#a9fe42dea26d4f9c8da030ad751abe0c3">SPECULATION_CNT</a>];  <span class="comment">// queue for function nodes to put their results in</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">// each function_node should have its own graph</span></div><div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#a65817fc08dbc725418246184b415c37b">  100</a></span>&#160;<a class="code" href="som__graph_8cpp.html#ac02b98124e6089e89a3bddb09e2cedb6">search_node_array_type</a>* <a class="code" href="som__graph_8cpp.html#a65817fc08dbc725418246184b415c37b">s_array</a>[<a class="code" href="som__graph_8cpp.html#a9fe42dea26d4f9c8da030ad751abe0c3">SPECULATION_CNT</a>];  <span class="comment">// 2d array of function nodes</span></div><div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#ad3657397720c988c9f8b3301c078454f">  101</a></span>&#160;<a class="code" href="som__graph_8cpp.html#a982a1edf1c14348e55ab93f8f8afa0cb">graph_array_type</a>* <a class="code" href="som__graph_8cpp.html#ad3657397720c988c9f8b3301c078454f">g_array</a>[<a class="code" href="som__graph_8cpp.html#a9fe42dea26d4f9c8da030ad751abe0c3">SPECULATION_CNT</a>];        <span class="comment">// 2d array of graphs</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">// build a set of SPECULATION_CNT graphs, each of which consists of a broadcast_node,</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">//    xranges x yranges function_nodes, and one queue_node for output.</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">//    once speculation starts, if i % SPECULATION_CNT is the current graph, (i+1) % SPECULATION_CNT</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">//    is the first speculation, and so on.</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#aa67128caf3a7354984ecdcb5dadf712d">  108</a></span>&#160;<a class="code" href="som__graph_8cpp.html#aa67128caf3a7354984ecdcb5dadf712d">build_BMU_graph</a>(<a class="code" href="classSOMap.html">SOMap</a> &amp;map1) {</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// build current graph</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="som__graph_8cpp.html#ae493181272fa9ab0f26074f3d55fa27a">xsize</a> = ((<a class="code" href="ittnotify__static_8h.html#ac89988b817e773286215b17e80359ff3">int</a>)map1.<a class="code" href="classSOMap.html#af77942b9164afaca599c67dcf9b0084f">size</a>() + <a class="code" href="som__graph_8cpp.html#a32af869bbcd0ede2149253f2db7bd0be">xranges</a> - 1) / <a class="code" href="som__graph_8cpp.html#a32af869bbcd0ede2149253f2db7bd0be">xranges</a>;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="som__graph_8cpp.html#ac70272affec5182515dd40abe4c39f80">ysize</a> = ((<a class="code" href="ittnotify__static_8h.html#ac89988b817e773286215b17e80359ff3">int</a>)map1[0].<a class="code" href="ittnotify__static_8h.html#a4a00e290d8b5952279115bbff9892198">size</a>() + <a class="code" href="som__graph_8cpp.html#a3de923087d7d6385616dfc3582306007">yranges</a> - 1) / <a class="code" href="som__graph_8cpp.html#a3de923087d7d6385616dfc3582306007">yranges</a>;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="som__graph_8cpp.html#a40d65054c8b42f7adf2389202f03d77d">function_node_execs</a>.clear();</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="som__graph_8cpp.html#a40d65054c8b42f7adf2389202f03d77d">function_node_execs</a>.reserve(<a class="code" href="som__graph_8cpp.html#a32af869bbcd0ede2149253f2db7bd0be">xranges</a>*<a class="code" href="som__graph_8cpp.html#a3de923087d7d6385616dfc3582306007">yranges</a>+1);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii = 0; ii &lt; <a class="code" href="som__graph_8cpp.html#a32af869bbcd0ede2149253f2db7bd0be">xranges</a>*<a class="code" href="som__graph_8cpp.html#a3de923087d7d6385616dfc3582306007">yranges</a>+1;++ii) <a class="code" href="som__graph_8cpp.html#a40d65054c8b42f7adf2389202f03d77d">function_node_execs</a>.push_back(0);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> scnt = 0; scnt &lt; <a class="code" href="som__graph_8cpp.html#a9fe42dea26d4f9c8da030ad751abe0c3">SPECULATION_CNT</a>; ++scnt) {</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <a class="code" href="som__graph_8cpp.html#a7ffc60a847109480ec0320f8f4f181fc">g</a>[scnt] = <span class="keyword">new</span> graph;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <a class="code" href="som__graph_8cpp.html#a749a410cadcbe27cfb4afef68a41a0c7">send_to</a>[scnt] = <span class="keyword">new</span> <a class="code" href="som__graph_8cpp.html#a02484ba0b62481bba766aeefbb717520">b_node</a>(*(<a class="code" href="som__graph_8cpp.html#a7ffc60a847109480ec0320f8f4f181fc">g</a>[scnt]));  <span class="comment">// broadcast node to the function_nodes</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <a class="code" href="som__graph_8cpp.html#ae900b2add8deca663438fb20de69acce">q</a>[scnt] = <span class="keyword">new</span> queue_node&lt;search_result_type&gt;(*(<a class="code" href="som__graph_8cpp.html#a7ffc60a847109480ec0320f8f4f181fc">g</a>[scnt]));  <span class="comment">// output queue</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="comment">// create the function_nodes, tie to the graph</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <a class="code" href="som__graph_8cpp.html#a65817fc08dbc725418246184b415c37b">s_array</a>[scnt] = <span class="keyword">new</span> <a class="code" href="som__graph_8cpp.html#ac02b98124e6089e89a3bddb09e2cedb6">search_node_array_type</a>;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <a class="code" href="som__graph_8cpp.html#a65817fc08dbc725418246184b415c37b">s_array</a>[scnt]-&gt;reserve(<a class="code" href="som__graph_8cpp.html#a32af869bbcd0ede2149253f2db7bd0be">xranges</a>);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <a class="code" href="som__graph_8cpp.html#ad3657397720c988c9f8b3301c078454f">g_array</a>[scnt] = <span class="keyword">new</span> <a class="code" href="som__graph_8cpp.html#a982a1edf1c14348e55ab93f8f8afa0cb">graph_array_type</a>;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <a class="code" href="som__graph_8cpp.html#ad3657397720c988c9f8b3301c078454f">g_array</a>[scnt]-&gt;reserve(<a class="code" href="som__graph_8cpp.html#a32af869bbcd0ede2149253f2db7bd0be">xranges</a>);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; (<a class="code" href="ittnotify__static_8h.html#ac89988b817e773286215b17e80359ff3">int</a>)map1.<a class="code" href="classSOMap.html#af77942b9164afaca599c67dcf9b0084f">size</a>(); i += <a class="code" href="som__graph_8cpp.html#ae493181272fa9ab0f26074f3d55fa27a">xsize</a>) {</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            <span class="keywordtype">int</span> xindex = i / <a class="code" href="som__graph_8cpp.html#ae493181272fa9ab0f26074f3d55fa27a">xsize</a>;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            <a class="code" href="som__graph_8cpp.html#a65817fc08dbc725418246184b415c37b">s_array</a>[scnt]-&gt;push_back(<a class="code" href="som__graph_8cpp.html#a5754e5878c4a4653f2c3313aa0c9fdbe">search_node_vector_type</a>());</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            (*<a class="code" href="som__graph_8cpp.html#a65817fc08dbc725418246184b415c37b">s_array</a>[scnt])[xindex].reserve(yranges);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <a class="code" href="som__graph_8cpp.html#ad3657397720c988c9f8b3301c078454f">g_array</a>[scnt]-&gt;push_back(<a class="code" href="som__graph_8cpp.html#a1a5969e9de846424d9d6d02491a5fa32">graph_vector_type</a>());</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            (*<a class="code" href="som__graph_8cpp.html#ad3657397720c988c9f8b3301c078454f">g_array</a>[scnt])[xindex].reserve(yranges);</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <span class="keywordflow">for</span>( <span class="keywordtype">int</span> j = 0; j &lt; (<a class="code" href="ittnotify__static_8h.html#ac89988b817e773286215b17e80359ff3">int</a>)map1[0].<a class="code" href="ittnotify__static_8h.html#a4a00e290d8b5952279115bbff9892198">size</a>(); j += <a class="code" href="som__graph_8cpp.html#ac70272affec5182515dd40abe4c39f80">ysize</a>) {</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                <span class="keywordtype">int</span> offset = (i/<a class="code" href="som__graph_8cpp.html#ae493181272fa9ab0f26074f3d55fa27a">xsize</a>)*yranges + (j / <a class="code" href="som__graph_8cpp.html#ac70272affec5182515dd40abe4c39f80">ysize</a>);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                <span class="keywordtype">int</span> xmax = (i + <a class="code" href="som__graph_8cpp.html#ae493181272fa9ab0f26074f3d55fa27a">xsize</a>) &gt; (<span class="keywordtype">int</span>)map1.<a class="code" href="classSOMap.html#af77942b9164afaca599c67dcf9b0084f">size</a>() ? (<a class="code" href="ittnotify__static_8h.html#ac89988b817e773286215b17e80359ff3">int</a>)map1.<a class="code" href="classSOMap.html#af77942b9164afaca599c67dcf9b0084f">size</a>() : i + <a class="code" href="som__graph_8cpp.html#ae493181272fa9ab0f26074f3d55fa27a">xsize</a>;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                <span class="keywordtype">int</span> ymax = (j + <a class="code" href="som__graph_8cpp.html#ac70272affec5182515dd40abe4c39f80">ysize</a>) &gt; (<span class="keywordtype">int</span>)map1[0].<a class="code" href="classSOMap.html#af77942b9164afaca599c67dcf9b0084f">size</a>() ? (<a class="code" href="ittnotify__static_8h.html#ac89988b817e773286215b17e80359ff3">int</a>)map1[0].<a class="code" href="ittnotify__static_8h.html#a4a00e290d8b5952279115bbff9892198">size</a>() : j + <a class="code" href="som__graph_8cpp.html#ac70272affec5182515dd40abe4c39f80">ysize</a>;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                <a class="code" href="classtbb_1_1blocked__range2d.html">subsquare_type</a> sst(i,xmax,1,j,ymax,1);</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                <a class="code" href="classBMU__search__body.html">BMU_search_body</a> bb(map1,sst,<a class="code" href="som__graph_8cpp.html#a40d65054c8b42f7adf2389202f03d77d">function_node_execs</a>[offset]);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                graph *g_local = <span class="keyword">new</span> graph;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                <a class="code" href="som__graph_8cpp.html#a9fd160e78600bbd232c1f19085cd3c39">search_node</a> *<a class="code" href="ittnotify__static_8h.html#a571c9802609300b38fd3d5ac52b1773c">s</a> = <span class="keyword">new</span> <a class="code" href="som__graph_8cpp.html#a9fd160e78600bbd232c1f19085cd3c39">search_node</a>(*g_local, <a class="code" href="namespacetbb_1_1flow.html#a7bec4a3445fea3cd5974119730dea98fa76917a07891f92f41cfe7b357e1fa874">serial</a>, bb); <span class="comment">// copies Body</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                (*<a class="code" href="som__graph_8cpp.html#ad3657397720c988c9f8b3301c078454f">g_array</a>[scnt])[xindex].push_back(g_local);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                (*<a class="code" href="som__graph_8cpp.html#a65817fc08dbc725418246184b415c37b">s_array</a>[scnt])[xindex].push_back(s);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                make_edge(*(<a class="code" href="som__graph_8cpp.html#a749a410cadcbe27cfb4afef68a41a0c7">send_to</a>[scnt]), *s);  <span class="comment">// broadcast_node -&gt; function_node</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                make_edge(*s, *(<a class="code" href="som__graph_8cpp.html#ae900b2add8deca663438fb20de69acce">q</a>[scnt]));   <span class="comment">// function_node -&gt; queue_node</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            }</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        }</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    }</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;}</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">// Wait for the 2D array of flow::graphs.</span></div><div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#a5fbb22abffc00845a74ad89b7eb0e94b">  150</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="som__graph_8cpp.html#a5fbb22abffc00845a74ad89b7eb0e94b">wait_for_all_graphs</a>(<span class="keywordtype">int</span> cIndex) {  <span class="comment">// cIndex ranges over [0 .. SPECULATION_CNT - 1]</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> x = 0; x &lt; <a class="code" href="som__graph_8cpp.html#a32af869bbcd0ede2149253f2db7bd0be">xranges</a>; ++x) {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> y = 0; y &lt; <a class="code" href="som__graph_8cpp.html#a3de923087d7d6385616dfc3582306007">yranges</a>; ++y) {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            (*<a class="code" href="som__graph_8cpp.html#ad3657397720c988c9f8b3301c078454f">g_array</a>[cIndex])[x][y]-&gt;wait_for_all();</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    }</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;}</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#a07e79bb54f885c01c8419c4c99d8e5f9">  159</a></span>&#160;<a class="code" href="som__graph_8cpp.html#a07e79bb54f885c01c8419c4c99d8e5f9">destroy_BMU_graph</a>() {</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> scnt = 0; scnt &lt; <a class="code" href="som__graph_8cpp.html#a9fe42dea26d4f9c8da030ad751abe0c3">SPECULATION_CNT</a>; ++scnt) {</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; (<a class="code" href="ittnotify__static_8h.html#ac89988b817e773286215b17e80359ff3">int</a>)(*<a class="code" href="som__graph_8cpp.html#a65817fc08dbc725418246184b415c37b">s_array</a>[scnt]).size(); ++i ) {</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; (<a class="code" href="ittnotify__static_8h.html#ac89988b817e773286215b17e80359ff3">int</a>)(*<a class="code" href="som__graph_8cpp.html#a65817fc08dbc725418246184b415c37b">s_array</a>[scnt])[i].size(); ++j) {</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                <span class="keyword">delete</span> (*<a class="code" href="som__graph_8cpp.html#a65817fc08dbc725418246184b415c37b">s_array</a>[scnt])[i][j];</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                <span class="keyword">delete</span> (*<a class="code" href="som__graph_8cpp.html#ad3657397720c988c9f8b3301c078454f">g_array</a>[scnt])[i][j];</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            }</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        }</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        (*<a class="code" href="som__graph_8cpp.html#a65817fc08dbc725418246184b415c37b">s_array</a>[scnt]).clear();</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keyword">delete</span> <a class="code" href="som__graph_8cpp.html#a65817fc08dbc725418246184b415c37b">s_array</a>[scnt];</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        (*<a class="code" href="som__graph_8cpp.html#ad3657397720c988c9f8b3301c078454f">g_array</a>[scnt]).clear();</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keyword">delete</span> <a class="code" href="som__graph_8cpp.html#ad3657397720c988c9f8b3301c078454f">g_array</a>[scnt];</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keyword">delete</span> <a class="code" href="som__graph_8cpp.html#ae900b2add8deca663438fb20de69acce">q</a>[scnt];</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="keyword">delete</span> <a class="code" href="som__graph_8cpp.html#a749a410cadcbe27cfb4afef68a41a0c7">send_to</a>[scnt];</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keyword">delete</span> <a class="code" href="som__graph_8cpp.html#a7ffc60a847109480ec0320f8f4f181fc">g</a>[scnt];</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    }</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;}</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#a842e1d2a64e9b3b014fc4993da3a769d">  177</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="som__graph_8cpp.html#a842e1d2a64e9b3b014fc4993da3a769d">find_subrange_overlap</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> &amp;xval, <span class="keywordtype">int</span> <span class="keyword">const</span> &amp;yval, <span class="keywordtype">double</span> <span class="keyword">const</span> &amp;radius, <span class="keywordtype">int</span> &amp;xlow, <span class="keywordtype">int</span> &amp;xhigh, <span class="keywordtype">int</span> &amp;ylow, <span class="keywordtype">int</span> &amp;yhigh) {</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    xlow = <a class="code" href="ittnotify__static_8h.html#ac89988b817e773286215b17e80359ff3">int</a>((xval-radius)/<a class="code" href="som__graph_8cpp.html#ae493181272fa9ab0f26074f3d55fa27a">xsize</a>);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    xhigh = <a class="code" href="ittnotify__static_8h.html#ac89988b817e773286215b17e80359ff3">int</a>((xval+radius)/<a class="code" href="som__graph_8cpp.html#ae493181272fa9ab0f26074f3d55fa27a">xsize</a>);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    ylow = <a class="code" href="ittnotify__static_8h.html#ac89988b817e773286215b17e80359ff3">int</a>((yval-radius)/<a class="code" href="som__graph_8cpp.html#ac70272affec5182515dd40abe4c39f80">ysize</a>);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    yhigh = <a class="code" href="ittnotify__static_8h.html#ac89988b817e773286215b17e80359ff3">int</a>((yval+radius)/<a class="code" href="som__graph_8cpp.html#ac70272affec5182515dd40abe4c39f80">ysize</a>);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">// circle may fall partly outside map</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">if</span>(xlow &lt; 0) xlow = 0;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">if</span>(xhigh &gt;= <a class="code" href="som__graph_8cpp.html#a32af869bbcd0ede2149253f2db7bd0be">xranges</a>) xhigh = <a class="code" href="som__graph_8cpp.html#a32af869bbcd0ede2149253f2db7bd0be">xranges</a> - 1;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">if</span>(ylow &lt; 0) ylow = 0;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">if</span>(yhigh &gt;= <a class="code" href="som__graph_8cpp.html#a3de923087d7d6385616dfc3582306007">yranges</a>) yhigh = <a class="code" href="som__graph_8cpp.html#a3de923087d7d6385616dfc3582306007">yranges</a> - 1;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#a0507a1193708ea4285fc35faf040050c">  189</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="som__graph_8cpp.html#a0507a1193708ea4285fc35faf040050c">overlap</a>( <span class="keywordtype">int</span> &amp;xval, <span class="keywordtype">int</span> &amp;yval, <a class="code" href="som_8h.html#a16eb97d90e5683b87599279f1c47db48">search_result_type</a> &amp;sr) {</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordtype">int</span> xlow, xhigh, ylow, yhigh;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="som__graph_8cpp.html#a842e1d2a64e9b3b014fc4993da3a769d">find_subrange_overlap</a>(get&lt;XV&gt;(sr), get&lt;YV&gt;(sr), get&lt;RADIUS&gt;(sr), xlow, xhigh, ylow, yhigh);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">return</span> xval &gt;= xlow &amp;&amp; xval &lt;= xhigh &amp;&amp; yval &gt;= ylow &amp;&amp; yval &lt;= yhigh;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;}</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#a2d37cb2553682a378c0796186cd9b505">  196</a></span>&#160;<a class="code" href="som__graph_8cpp.html#a2d37cb2553682a378c0796186cd9b505">cancel_submaps</a>(<span class="keywordtype">int</span> &amp;xval, <span class="keywordtype">int</span> &amp;yval, <span class="keywordtype">double</span> &amp;radius, <span class="keywordtype">int</span> <a class="code" href="polymain_8cpp.html#aff394e352c809421b815b9a8e40f3c64">indx</a>) {</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordtype">int</span> xlow;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordtype">int</span> xhigh;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordtype">int</span> ylow;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordtype">int</span> yhigh;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="som__graph_8cpp.html#a842e1d2a64e9b3b014fc4993da3a769d">find_subrange_overlap</a>(xval, yval, radius, xlow, xhigh, ylow, yhigh);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> x = xlow; x &lt;= xhigh; ++x) {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> y = ylow; y &lt;= yhigh; ++y) {</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            (*<a class="code" href="som__graph_8cpp.html#ad3657397720c988c9f8b3301c078454f">g_array</a>[<a class="code" href="polymain_8cpp.html#aff394e352c809421b815b9a8e40f3c64">indx</a>])[x][y]-&gt;root_task()-&gt;cancel_group_execution();</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    }</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;}</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00210"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#a2ec5416ecbe67756ad26d860f8e61fbe">  210</a></span>&#160;<a class="code" href="som__graph_8cpp.html#a2ec5416ecbe67756ad26d860f8e61fbe">restart_submaps</a>(<span class="keywordtype">int</span> &amp;xval, <span class="keywordtype">int</span> &amp;yval, <span class="keywordtype">double</span> &amp;radius, <span class="keywordtype">int</span> <a class="code" href="polymain_8cpp.html#aff394e352c809421b815b9a8e40f3c64">indx</a>, <a class="code" href="classSOM__element.html">SOM_element</a> &amp;vector) {</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordtype">int</span> xlow;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordtype">int</span> xhigh;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordtype">int</span> ylow;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordtype">int</span> yhigh;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="som__graph_8cpp.html#a842e1d2a64e9b3b014fc4993da3a769d">find_subrange_overlap</a>(xval, yval, radius, xlow, xhigh, ylow, yhigh);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> x = xlow; x &lt;= xhigh; ++x) {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> y = ylow; y &lt;= yhigh; ++y) {</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <span class="comment">// have to reset the graph</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            (*<a class="code" href="som__graph_8cpp.html#ad3657397720c988c9f8b3301c078454f">g_array</a>[<a class="code" href="polymain_8cpp.html#aff394e352c809421b815b9a8e40f3c64">indx</a>])[x][y]-&gt;root_task()-&gt;context()-&gt;reset();</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            <span class="comment">// and re-submit the exemplar for search.</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            (*<a class="code" href="som__graph_8cpp.html#a65817fc08dbc725418246184b415c37b">s_array</a>[<a class="code" href="polymain_8cpp.html#aff394e352c809421b815b9a8e40f3c64">indx</a>])[x][y]-&gt;try_put(vector);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        }</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    }</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;}</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<a class="code" href="som_8h.html#a16eb97d90e5683b87599279f1c47db48">search_result_type</a></div><div class="line"><a name="l00227"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#af13b06d6aed76fcc4b8502e3e84a6dcd">  227</a></span>&#160;<a class="code" href="som__graph_8cpp.html#af13b06d6aed76fcc4b8502e3e84a6dcd">graph_BMU</a>( <span class="keywordtype">int</span> <a class="code" href="polymain_8cpp.html#aff394e352c809421b815b9a8e40f3c64">indx</a> ) {  <span class="comment">// indx ranges over [0 .. SPECULATION_CNT -1]</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="som__graph_8cpp.html#a5fbb22abffc00845a74ad89b7eb0e94b">wait_for_all_graphs</a>(indx);  <span class="comment">// wait for the array of subgraphs</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    (<a class="code" href="som__graph_8cpp.html#a7ffc60a847109480ec0320f8f4f181fc">g</a>[<a class="code" href="polymain_8cpp.html#aff394e352c809421b815b9a8e40f3c64">indx</a>])-&gt;wait_for_all();</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    std::vector&lt;search_result_type&gt; all_srs(<a class="code" href="som__graph_8cpp.html#a1055305a3f037f731953b55723e1b12e">xRangeMax</a>*<a class="code" href="som__graph_8cpp.html#af1faccf35e9005eed4d1259fb2ae3f1b">yRangeMax</a>,<a class="code" href="som_8h.html#a16eb97d90e5683b87599279f1c47db48">search_result_type</a>(DBL_MAX,-1,-1));</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <a class="code" href="som_8h.html#a16eb97d90e5683b87599279f1c47db48">search_result_type</a> sr;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="som_8h.html#a16eb97d90e5683b87599279f1c47db48">search_result_type</a> min_sr;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    get&lt;RADIUS&gt;(min_sr) = DBL_MAX;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordtype">int</span> result_count = 0;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">while</span>((<a class="code" href="som__graph_8cpp.html#ae900b2add8deca663438fb20de69acce">q</a>[indx])-&gt;try_get(sr)) {</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        ++result_count;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="comment">// figure which submap this came from</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keywordtype">int</span> x = get&lt;XV&gt;(sr) / <a class="code" href="som__graph_8cpp.html#ae493181272fa9ab0f26074f3d55fa27a">xsize</a>;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keywordtype">int</span> y = get&lt;YV&gt;(sr) / <a class="code" href="som__graph_8cpp.html#ac70272affec5182515dd40abe4c39f80">ysize</a>;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keywordtype">int</span> offset = x*<a class="code" href="som__graph_8cpp.html#a3de923087d7d6385616dfc3582306007">yranges</a>+y;  <span class="comment">// linearized subscript</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        all_srs[offset] = sr;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordflow">if</span>(get&lt;RADIUS&gt;(sr) &lt; get&lt;RADIUS&gt;(min_sr))</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            min_sr = sr;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(get&lt;RADIUS&gt;(sr) == get&lt;RADIUS&gt;(min_sr)) {</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keywordflow">if</span>(get&lt;XV&gt;(sr) &lt; get&lt;XV&gt;(min_sr)) {</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                min_sr = sr;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            }</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>((get&lt;XV&gt;(sr) == get&lt;XV&gt;(min_sr) &amp;&amp;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                  get&lt;YV&gt;(sr) &lt; get&lt;YV&gt;(min_sr)))</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                min_sr = sr;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            }</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        }</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    }</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">return</span> min_sr;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="comment">// end of one epoch</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;}</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#ad1197662ffee752cab7ad2b523528278">  259</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="som__graph_8cpp.html#ad1197662ffee752cab7ad2b523528278">graph_teach</a>(<a class="code" href="classSOMap.html">SOMap</a> &amp;map1, <a class="code" href="som_8h.html#aaf4309fa3669886305579010786a9d9a">teaching_vector_type</a> &amp;in) {</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="som__graph_8cpp.html#aa67128caf3a7354984ecdcb5dadf712d">build_BMU_graph</a>(map1);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">// normally the training would pick random exemplars to teach the SOM.  We need</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">// the process to be reproducible, so we will pick the exemplars in order, [0, in.size())</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordtype">int</span> next_j = 0;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> epoch = 0; epoch &lt; nPasses; ++epoch) {</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <a class="code" href="som__graph_8cpp.html#ab2687047943e58dbb6df86106a2659e8">global_i</a> = epoch;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordtype">bool</span> canceled_submaps = <span class="keyword">false</span>;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="keywordtype">int</span> j = next_j;  <span class="comment">// try to make reproducible</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        next_j = (epoch+1) % in.size();</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <a class="code" href="som_8h.html#a16eb97d90e5683b87599279f1c47db48">search_result_type</a> min_sr;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keywordflow">if</span>(epoch &lt; <a class="code" href="som__graph_8cpp.html#aa818eee885a2527c70ff82b2ef23e3e4">speculation_start</a>) {</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            (<a class="code" href="som__graph_8cpp.html#a749a410cadcbe27cfb4afef68a41a0c7">send_to</a>[epoch%<a class="code" href="som__graph_8cpp.html#a9fe42dea26d4f9c8da030ad751abe0c3">SPECULATION_CNT</a>])-&gt;try_put(in[j]);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        }</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(epoch == <a class="code" href="som__graph_8cpp.html#aa818eee885a2527c70ff82b2ef23e3e4">speculation_start</a>) {</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            (<a class="code" href="som__graph_8cpp.html#a749a410cadcbe27cfb4afef68a41a0c7">send_to</a>[epoch%<a class="code" href="som__graph_8cpp.html#a9fe42dea26d4f9c8da030ad751abe0c3">SPECULATION_CNT</a>])-&gt;try_put(in[j]);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <span class="keywordflow">if</span>(epoch &lt; nPasses-1) {</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                (<a class="code" href="som__graph_8cpp.html#a749a410cadcbe27cfb4afef68a41a0c7">send_to</a>[(epoch+1)%<a class="code" href="som__graph_8cpp.html#a9fe42dea26d4f9c8da030ad751abe0c3">SPECULATION_CNT</a>])-&gt;try_put(in[next_j]);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            }</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        }</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(epoch &lt; nPasses - 1) {</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            (<a class="code" href="som__graph_8cpp.html#a749a410cadcbe27cfb4afef68a41a0c7">send_to</a>[(epoch+1)%<a class="code" href="som__graph_8cpp.html#a9fe42dea26d4f9c8da030ad751abe0c3">SPECULATION_CNT</a>])-&gt;try_put(in[next_j]);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        }</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        min_sr = <a class="code" href="som__graph_8cpp.html#af13b06d6aed76fcc4b8502e3e84a6dcd">graph_BMU</a>(epoch % <a class="code" href="som__graph_8cpp.html#a9fe42dea26d4f9c8da030ad751abe0c3">SPECULATION_CNT</a>);  <span class="comment">//calls wait_for_all()</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keywordtype">double</span> min_distance = get&lt;0&gt;(min_sr);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="keywordtype">double</span> radius = <a class="code" href="som_8h.html#ab6bbfa436100819c81fd865cb0bdd55b">max_radius</a> * <a class="code" href="EvtComplex_8hh.html#a6ffa44cf63579d02f7ad8266f5792805">exp</a>(-(<span class="keywordtype">double</span>)epoch*<a class="code" href="som_8h.html#a7473a27543a23a8020ad7d518da0c9ab">radius_decay_rate</a>);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordtype">double</span> learning_rate = max_learning_rate * <a class="code" href="EvtComplex_8hh.html#a6ffa44cf63579d02f7ad8266f5792805">exp</a>(-(<span class="keywordtype">double</span>)epoch * learning_decay_rate);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="keywordflow">if</span>(epoch &gt;= <a class="code" href="som__graph_8cpp.html#aa818eee885a2527c70ff82b2ef23e3e4">speculation_start</a> &amp;&amp; epoch &lt; (nPasses - 1)) {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <span class="comment">// have to cancel the affected submaps</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            <a class="code" href="som__graph_8cpp.html#a2d37cb2553682a378c0796186cd9b505">cancel_submaps</a>(get&lt;XV&gt;(min_sr), get&lt;YV&gt;(min_sr), radius, (epoch+1)%SPECULATION_CNT);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            canceled_submaps = <span class="keyword">true</span>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        }</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        map1.<a class="code" href="classSOMap.html#a8a7acff305596d58524faa4404424bb2">epoch_update</a>(in[j], epoch, get&lt;1&gt;(min_sr), get&lt;2&gt;(min_sr), radius, learning_rate);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        ++<a class="code" href="som__graph_8cpp.html#ab2687047943e58dbb6df86106a2659e8">global_i</a>;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="keywordflow">if</span>(canceled_submaps) {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            <span class="comment">// do I have to wait for all the non-canceled speculative graph to complete first?</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            <span class="comment">// yes, in case a canceled task was already executing.</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <a class="code" href="som__graph_8cpp.html#a5fbb22abffc00845a74ad89b7eb0e94b">wait_for_all_graphs</a>((epoch+1) % SPECULATION_CNT);  <span class="comment">// wait for the array of subgraphs</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            <a class="code" href="som__graph_8cpp.html#a2ec5416ecbe67756ad26d860f8e61fbe">restart_submaps</a>(get&lt;1&gt;(min_sr), get&lt;2&gt;(min_sr), radius, (epoch+1)%SPECULATION_CNT, in[next_j]);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <a class="code" href="som__graph_8cpp.html#a1f78f8cac44d71bb1f9e980bc2ddc65d">last_update</a> = min_sr;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        get&lt;RADIUS&gt;(<a class="code" href="som__graph_8cpp.html#a1f78f8cac44d71bb1f9e980bc2ddc65d">last_update</a>) = radius;  <span class="comment">// not smallest value, but range of effect</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    }</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="som__graph_8cpp.html#a07e79bb54f885c01c8419c4c99d8e5f9">destroy_BMU_graph</a>();</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;}</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#a96bebcac017dd57d90a6d13ad4b23cac">  306</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="som__graph_8cpp.html#a96bebcac017dd57d90a6d13ad4b23cac">serial_time_adjust</a> = 1.25;</div><div class="line"><a name="l00307"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#a1ec46622a6ff23cae124e6d9465ab254">  307</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="som__graph_8cpp.html#a1ec46622a6ff23cae124e6d9465ab254">radius_fraction</a> = 3.0;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l00310"></a><span class="lineno"><a class="line" href="som__graph_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">  310</a></span>&#160;<a class="code" href="som__graph_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv) {</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordtype">int</span> l_speculation_start;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <a class="code" href="structutility_1_1thread__number__range.html">utility::thread_number_range</a> <a class="code" href="parallel__do_2parallel__preorder_2main_8cpp.html#af8065db2316481fa4c97f936e8104a98">threads</a>( </div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            task_scheduler_init::default_num_threads,</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            task_scheduler_init::default_num_threads()  <span class="comment">// run only the default number of threads if none specified</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    );</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <a class="code" href="namespaceutility.html#abe6afd617ae93bf41147e2d82c23eb07">utility::parse_cli_arguments</a>(argc,argv,</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            <a class="code" href="classutility_1_1cli__argument__pack.html">utility::cli_argument_pack</a>()</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            <span class="comment">//&quot;-h&quot; option for for displaying help is present implicitly</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            .positional_arg(threads,<span class="stringliteral">&quot;n-of-threads&quot;</span>,<span class="stringliteral">&quot;number of threads to use; a range of the form low[:high], where low and optional high are non-negative integers or &#39;auto&#39; for the TBB default.&quot;</span>)</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            <span class="comment">// .positional_arg(InputFileName,&quot;input-file&quot;,&quot;input file name&quot;)</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            <span class="comment">// .positional_arg(OutputFileName,&quot;output-file&quot;,&quot;output file name&quot;)</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            .positional_arg(<a class="code" href="som__graph_8cpp.html#a1ec46622a6ff23cae124e6d9465ab254">radius_fraction</a>, <span class="stringliteral">&quot;radius-fraction&quot;</span>,<span class="stringliteral">&quot;size of radius at which to start speculating&quot;</span>)</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            .positional_arg(nPasses, <span class="stringliteral">&quot;number-of-epochs&quot;</span>,<span class="stringliteral">&quot;number of examples used in learning phase&quot;</span>)</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            .<a class="code" href="EvtComplex_8hh.html#af38e3c23adf905b08480ac93be90bb16">arg</a>(cancel_test, <span class="stringliteral">&quot;cancel-test&quot;</span>, <span class="stringliteral">&quot;test for cancel signal while finding BMU&quot;</span>)</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            .<a class="code" href="EvtComplex_8hh.html#af38e3c23adf905b08480ac93be90bb16">arg</a>(extra_debug, <span class="stringliteral">&quot;debug&quot;</span>, <span class="stringliteral">&quot;additional output&quot;</span>)</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            .<a class="code" href="EvtComplex_8hh.html#af38e3c23adf905b08480ac93be90bb16">arg</a>(<a class="code" href="som__graph_8cpp.html#a4249b3ebda4de972d24aa1d6d940736f">dont_speculate</a>,<span class="stringliteral">&quot;nospeculate&quot;</span>,<span class="stringliteral">&quot;don&#39;t speculate in SOM map teaching&quot;</span>)</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;         );</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="som_8cpp.html#a44345bd3822e2e47f94a01bdc85a1c13">readInputData</a>();</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <a class="code" href="som_8h.html#ab6bbfa436100819c81fd865cb0bdd55b">max_radius</a> = (xMax &lt; yMax) ? yMax / 2 : xMax / 2;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">// need this value for the 1x1 timing below</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <a class="code" href="som_8h.html#a7473a27543a23a8020ad7d518da0c9ab">radius_decay_rate</a> = -(log(1.0/(<span class="keywordtype">double</span>)<a class="code" href="som_8h.html#ab6bbfa436100819c81fd865cb0bdd55b">max_radius</a>) / (double)nPasses);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <a class="code" href="som_8cpp.html#a09587cd79c200644af779dd457110d4b">find_data_ranges</a>(<a class="code" href="som_8h.html#a19c1f05ef6e47d9402405627974fb809">my_teaching</a>, <a class="code" href="som_8h.html#a2f3b22b4e61a19afa6c2e45bedaeb62c">max_range</a>, <a class="code" href="som_8h.html#a7cdd2608e2f29ee63285cd7c4a51d310">min_range</a> );</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">if</span>(extra_debug) {</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        printf( <span class="stringliteral">&quot;Data range: &quot;</span>);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <a class="code" href="som_8cpp.html#afaa2673447b95792a0e5b635cabe250f">remark_SOM_element</a>(<a class="code" href="som_8h.html#a7cdd2608e2f29ee63285cd7c4a51d310">min_range</a>);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        printf( <span class="stringliteral">&quot; to &quot;</span>);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <a class="code" href="som_8cpp.html#afaa2673447b95792a0e5b635cabe250f">remark_SOM_element</a>(<a class="code" href="som_8h.html#a2f3b22b4e61a19afa6c2e45bedaeb62c">max_range</a>);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        printf( <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    }</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">// find how much time is taken for the single function_node case.</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">// adjust nPasses so the 1x1 time is somewhere around serial_time_adjust seconds.</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;   <span class="comment">// make sure the example test runs for at least 0.5 second.</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">for</span>(;;) {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <a class="code" href="classtbb_1_1task__scheduler__init.html">task_scheduler_init</a> init(1);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <a class="code" href="classSOMap.html">SOMap</a> map1(xMax,yMax);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <a class="code" href="som__graph_8cpp.html#aa818eee885a2527c70ff82b2ef23e3e4">speculation_start</a> = nPasses + 1;  <span class="comment">// Don&#39;t speculate</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <a class="code" href="som__graph_8cpp.html#a32af869bbcd0ede2149253f2db7bd0be">xranges</a> = 1;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <a class="code" href="som__graph_8cpp.html#a3de923087d7d6385616dfc3582306007">yranges</a> = 1;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        map1.<a class="code" href="classSOMap.html#a19c3e6a13586e146ca859eea5f9fda08">initialize</a>(<a class="code" href="som_8h.html#abf29040eaa4190b2ece8bfba78874f65a52f66508417b1d9175ab91e972a54093">InitializeGradient</a>, <a class="code" href="som_8h.html#a2f3b22b4e61a19afa6c2e45bedaeb62c">max_range</a>, <a class="code" href="som_8h.html#a7cdd2608e2f29ee63285cd7c4a51d310">min_range</a>);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <a class="code" href="classtbb_1_1tick__count.html">tick_count</a> <a class="code" href="dining__philosophers_8cpp.html#acaabb53c59c5d280a13be2cf359335a9">t0</a> = tick_count::now();</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <a class="code" href="som__graph_8cpp.html#ad1197662ffee752cab7ad2b523528278">graph_teach</a>(map1, <a class="code" href="som_8h.html#a19c1f05ef6e47d9402405627974fb809">my_teaching</a>);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <a class="code" href="classtbb_1_1tick__count.html">tick_count</a> t1 = tick_count::now();</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keywordtype">double</span> nSeconds = (t1-<a class="code" href="dining__philosophers_8cpp.html#acaabb53c59c5d280a13be2cf359335a9">t0</a>).seconds();</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keywordflow">if</span>(nSeconds &lt; 0.5) {</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            xMax *= 2;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            yMax *= 2;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        }</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="keywordtype">double</span> size_adjust = sqrt(<a class="code" href="som__graph_8cpp.html#a96bebcac017dd57d90a6d13ad4b23cac">serial_time_adjust</a> / nSeconds);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        xMax = (<a class="code" href="ittnotify__static_8h.html#ac89988b817e773286215b17e80359ff3">int</a>)((<span class="keywordtype">double</span>)xMax * size_adjust);</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        yMax = (<a class="code" href="ittnotify__static_8h.html#ac89988b817e773286215b17e80359ff3">int</a>)((<span class="keywordtype">double</span>)yMax * size_adjust);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        max_radius = (xMax &lt; yMax) ? yMax / 2 : xMax / 2;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <a class="code" href="som_8h.html#a7473a27543a23a8020ad7d518da0c9ab">radius_decay_rate</a> = log((<span class="keywordtype">double</span>)max_radius) / (double)nPasses;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="keywordflow">if</span>(extra_debug) {</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            printf(<span class="stringliteral">&quot;original 1x1 case ran in %g seconds\n&quot;</span>, nSeconds);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            printf(<span class="stringliteral">&quot;   Size of table == %d x %d\n&quot;</span>, xMax, yMax);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            printf(<span class="stringliteral">&quot;   radius_decay_rate == %g\n&quot;</span>, <a class="code" href="som_8h.html#a7473a27543a23a8020ad7d518da0c9ab">radius_decay_rate</a>);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        }</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    }</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">// the &quot;max_radius&quot; starts at 1/2*radius_fraction the table size.  To start the speculation when the radius is</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="comment">// 1 / n * the table size, the constant in the log below should be n / 2.  so 2 == 1/4, 3 == 1/6th,</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="comment">// et c.</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="som__graph_8cpp.html#a4249b3ebda4de972d24aa1d6d940736f">dont_speculate</a>) {</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        l_speculation_start = nPasses + 1;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="keywordflow">if</span> ( extra_debug )printf(<span class="stringliteral">&quot;speculation will not be done\n&quot;</span>);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    }</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="som__graph_8cpp.html#a1ec46622a6ff23cae124e6d9465ab254">radius_fraction</a> &lt; 1.0 ) {</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            <span class="keywordflow">if</span> ( extra_debug )printf(<span class="stringliteral">&quot;Warning: radius_fraction should be &gt;= 1.  Setting to 1.\n&quot;</span>);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            <a class="code" href="som__graph_8cpp.html#a1ec46622a6ff23cae124e6d9465ab254">radius_fraction</a> = 1.0;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        }</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        l_speculation_start = (<a class="code" href="ittnotify__static_8h.html#ac89988b817e773286215b17e80359ff3">int</a>)((<span class="keywordtype">double</span>)nPasses * log(<a class="code" href="som__graph_8cpp.html#a1ec46622a6ff23cae124e6d9465ab254">radius_fraction</a>) / log((<span class="keywordtype">double</span>)nPasses)); </div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordflow">if</span> ( extra_debug )printf( <span class="stringliteral">&quot;We will start speculation at iteration %d\n&quot;</span>, l_speculation_start );</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    }</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordtype">double</span> single_time;  <span class="comment">// for speedup calculations</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="ittnotify__static_8h.html#ae01354a6a694c51fb79588444a08cbee">p</a> = threads.<a class="code" href="structutility_1_1thread__number__range.html#a816791e01e98597ec1e5f6856e5bd540">first</a>; <a class="code" href="ittnotify__static_8h.html#ae01354a6a694c51fb79588444a08cbee">p</a> &lt;= threads.<a class="code" href="structutility_1_1thread__number__range.html#af91460ff2be53ca1da029775ccd076a7">last</a>; ++<a class="code" href="ittnotify__static_8h.html#ae01354a6a694c51fb79588444a08cbee">p</a>) {</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <a class="code" href="classtbb_1_1task__scheduler__init.html">task_scheduler_init</a> init(<a class="code" href="ittnotify__static_8h.html#ae01354a6a694c51fb79588444a08cbee">p</a>);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="keywordflow">if</span> ( extra_debug )printf( <span class="stringliteral">&quot; -------------- Running with %d threads. ------------\n&quot;</span>, <a class="code" href="ittnotify__static_8h.html#ae01354a6a694c51fb79588444a08cbee">p</a>);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;       <span class="comment">// run the SOM build for a series of subranges</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="som__graph_8cpp.html#a32af869bbcd0ede2149253f2db7bd0be">xranges</a> = 1; <a class="code" href="som__graph_8cpp.html#a32af869bbcd0ede2149253f2db7bd0be">xranges</a> &lt;= <a class="code" href="som__graph_8cpp.html#a1055305a3f037f731953b55723e1b12e">xRangeMax</a>; ++<a class="code" href="som__graph_8cpp.html#a32af869bbcd0ede2149253f2db7bd0be">xranges</a>) {</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="som__graph_8cpp.html#a3de923087d7d6385616dfc3582306007">yranges</a> = <a class="code" href="som__graph_8cpp.html#a32af869bbcd0ede2149253f2db7bd0be">xranges</a>; <a class="code" href="som__graph_8cpp.html#a3de923087d7d6385616dfc3582306007">yranges</a> &lt;= <a class="code" href="som__graph_8cpp.html#af1faccf35e9005eed4d1259fb2ae3f1b">yRangeMax</a>; ++<a class="code" href="som__graph_8cpp.html#a3de923087d7d6385616dfc3582306007">yranges</a>) {</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="som__graph_8cpp.html#a32af869bbcd0ede2149253f2db7bd0be">xranges</a> == 1 &amp;&amp; <a class="code" href="som__graph_8cpp.html#a3de923087d7d6385616dfc3582306007">yranges</a> == 1) {</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                    <span class="comment">// don&#39;t pointlessly speculate if we&#39;re only running one subrange.</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                    <a class="code" href="som__graph_8cpp.html#aa818eee885a2527c70ff82b2ef23e3e4">speculation_start</a> = nPasses + 1;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                }</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                <span class="keywordflow">else</span> {</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                    <a class="code" href="som__graph_8cpp.html#aa818eee885a2527c70ff82b2ef23e3e4">speculation_start</a> = l_speculation_start;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                }</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                <a class="code" href="classSOMap.html">SOMap</a> map1(xMax, yMax);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                map1.<a class="code" href="classSOMap.html#a19c3e6a13586e146ca859eea5f9fda08">initialize</a>(<a class="code" href="som_8h.html#abf29040eaa4190b2ece8bfba78874f65a52f66508417b1d9175ab91e972a54093">InitializeGradient</a>, <a class="code" href="som_8h.html#a2f3b22b4e61a19afa6c2e45bedaeb62c">max_range</a>, <a class="code" href="som_8h.html#a7cdd2608e2f29ee63285cd7c4a51d310">min_range</a>);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    </div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                <span class="keywordflow">if</span>(extra_debug) printf( <span class="stringliteral">&quot;Start learning for [%d,%d] ----------- \n&quot;</span>, <a class="code" href="som__graph_8cpp.html#a32af869bbcd0ede2149253f2db7bd0be">xranges</a>,<a class="code" href="som__graph_8cpp.html#a3de923087d7d6385616dfc3582306007">yranges</a>);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                <a class="code" href="classtbb_1_1tick__count.html">tick_count</a> <a class="code" href="dining__philosophers_8cpp.html#acaabb53c59c5d280a13be2cf359335a9">t0</a> = tick_count::now();</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                <a class="code" href="som__graph_8cpp.html#ad1197662ffee752cab7ad2b523528278">graph_teach</a>(map1, <a class="code" href="som_8h.html#a19c1f05ef6e47d9402405627974fb809">my_teaching</a>);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                <a class="code" href="classtbb_1_1tick__count.html">tick_count</a> t1 = tick_count::now();</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                </div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                <span class="keywordflow">if</span> ( extra_debug )printf( <span class="stringliteral">&quot;Done learning for [%d,%d], which took %g seconds &quot;</span>, <a class="code" href="som__graph_8cpp.html#a32af869bbcd0ede2149253f2db7bd0be">xranges</a>,<a class="code" href="som__graph_8cpp.html#a3de923087d7d6385616dfc3582306007">yranges</a>, (t1-t0).seconds());</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="som__graph_8cpp.html#a32af869bbcd0ede2149253f2db7bd0be">xranges</a> == 1 &amp;&amp; <a class="code" href="som__graph_8cpp.html#a3de923087d7d6385616dfc3582306007">yranges</a> == 1) single_time = (t1-<a class="code" href="dining__philosophers_8cpp.html#acaabb53c59c5d280a13be2cf359335a9">t0</a>).seconds();</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                <span class="keywordflow">if</span> ( extra_debug )printf( <span class="stringliteral">&quot;: speedup == %g\n&quot;</span>, single_time / (t1-t0).seconds());</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    </div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            }  <span class="comment">// yranges</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        }  <span class="comment">// xranges</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    }  <span class="comment">// #threads p</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    printf(<span class="stringliteral">&quot;done\n&quot;</span>);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;}</div><div class="ttc" id="classBMU__search__body_html_a86d3a2fb1dd09da01f729f773c43f3ae"><div class="ttname"><a href="classBMU__search__body.html#a86d3a2fb1dd09da01f729f773c43f3ae">BMU_search_body::BMU_search_body</a></div><div class="ttdeci">BMU_search_body(SOMap &amp;_m, subsquare_type &amp;_sq, int &amp;fnt)</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00076">som_graph.cpp:76</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_a982a1edf1c14348e55ab93f8f8afa0cb"><div class="ttname"><a href="som__graph_8cpp.html#a982a1edf1c14348e55ab93f8f8afa0cb">graph_array_type</a></div><div class="ttdeci">std::vector&lt; graph_vector_type &gt; graph_array_type</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00092">som_graph.cpp:92</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_a1a5969e9de846424d9d6d02491a5fa32"><div class="ttname"><a href="som__graph_8cpp.html#a1a5969e9de846424d9d6d02491a5fa32">graph_vector_type</a></div><div class="ttdeci">std::vector&lt; graph * &gt; graph_vector_type</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00091">som_graph.cpp:91</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_aa818eee885a2527c70ff82b2ef23e3e4"><div class="ttname"><a href="som__graph_8cpp.html#aa818eee885a2527c70ff82b2ef23e3e4">speculation_start</a></div><div class="ttdeci">static int speculation_start</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00064">som_graph.cpp:64</a></div></div>
<div class="ttc" id="classSOMap_html"><div class="ttname"><a href="classSOMap.html">SOMap</a></div><div class="ttdef"><b>Definition:</b> <a href="som_8h_source.html#l00120">som.h:120</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_a65817fc08dbc725418246184b415c37b"><div class="ttname"><a href="som__graph_8cpp.html#a65817fc08dbc725418246184b415c37b">s_array</a></div><div class="ttdeci">search_node_array_type * s_array[SPECULATION_CNT]</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00100">som_graph.cpp:100</a></div></div>
<div class="ttc" id="dining__philosophers_8cpp_html_acaabb53c59c5d280a13be2cf359335a9"><div class="ttname"><a href="dining__philosophers_8cpp.html#acaabb53c59c5d280a13be2cf359335a9">t0</a></div><div class="ttdeci">tbb::tick_count t0</div><div class="ttdef"><b>Definition:</b> <a href="dining__philosophers_8cpp_source.html#l00056">dining_philosophers.cpp:56</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_ac70272affec5182515dd40abe4c39f80"><div class="ttname"><a href="som__graph_8cpp.html#ac70272affec5182515dd40abe4c39f80">ysize</a></div><div class="ttdeci">static int ysize</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00061">som_graph.cpp:61</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_a3de923087d7d6385616dfc3582306007"><div class="ttname"><a href="som__graph_8cpp.html#a3de923087d7d6385616dfc3582306007">yranges</a></div><div class="ttdeci">static int yranges</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00059">som_graph.cpp:59</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_a1055305a3f037f731953b55723e1b12e"><div class="ttname"><a href="som__graph_8cpp.html#a1055305a3f037f731953b55723e1b12e">xRangeMax</a></div><div class="ttdeci">static int xRangeMax</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00066">som_graph.cpp:66</a></div></div>
<div class="ttc" id="som_8cpp_html_a44345bd3822e2e47f94a01bdc85a1c13"><div class="ttname"><a href="som_8cpp.html#a44345bd3822e2e47f94a01bdc85a1c13">readInputData</a></div><div class="ttdeci">void readInputData()</div><div class="ttdef"><b>Definition:</b> <a href="som_8cpp_source.html#l00206">som.cpp:206</a></div></div>
<div class="ttc" id="classBMU__search__body_html_a0ab4ecd76ceb24fcdd45e0a00b4536cc"><div class="ttname"><a href="classBMU__search__body.html#a0ab4ecd76ceb24fcdd45e0a00b4536cc">BMU_search_body::my_square</a></div><div class="ttdeci">subsquare_type my_square</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00073">som_graph.cpp:73</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_a96bebcac017dd57d90a6d13ad4b23cac"><div class="ttname"><a href="som__graph_8cpp.html#a96bebcac017dd57d90a6d13ad4b23cac">serial_time_adjust</a></div><div class="ttdeci">static const double serial_time_adjust</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00306">som_graph.cpp:306</a></div></div>
<div class="ttc" id="classutility_1_1cli__argument__pack_html"><div class="ttname"><a href="classutility_1_1cli__argument__pack.html">utility::cli_argument_pack</a></div><div class="ttdef"><b>Definition:</b> <a href="utility_8h_source.html#l00193">utility.h:193</a></div></div>
<div class="ttc" id="parallel__do_2parallel__preorder_2main_8cpp_html_af8065db2316481fa4c97f936e8104a98"><div class="ttname"><a href="parallel__do_2parallel__preorder_2main_8cpp.html#af8065db2316481fa4c97f936e8104a98">threads</a></div><div class="ttdeci">utility::thread_number_range threads(tbb::task_scheduler_init::default_num_threads)</div></div>
<div class="ttc" id="som__graph_8cpp_html_ab2687047943e58dbb6df86106a2659e8"><div class="ttname"><a href="som__graph_8cpp.html#ab2687047943e58dbb6df86106a2659e8">global_i</a></div><div class="ttdeci">static int global_i</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00063">som_graph.cpp:63</a></div></div>
<div class="ttc" id="classBMU__search__body_html"><div class="ttname"><a href="classBMU__search__body.html">BMU_search_body</a></div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00071">som_graph.cpp:71</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_ad3657397720c988c9f8b3301c078454f"><div class="ttname"><a href="som__graph_8cpp.html#ad3657397720c988c9f8b3301c078454f">g_array</a></div><div class="ttdeci">graph_array_type * g_array[SPECULATION_CNT]</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00101">som_graph.cpp:101</a></div></div>
<div class="ttc" id="ittnotify__static_8h_html_a571c9802609300b38fd3d5ac52b1773c"><div class="ttname"><a href="ittnotify__static_8h.html#a571c9802609300b38fd3d5ac52b1773c">s</a></div><div class="ttdeci">void const char const char int ITT_FORMAT __itt_group_sync s</div><div class="ttdef"><b>Definition:</b> <a href="ittnotify__static_8h_source.html#l00080">ittnotify_static.h:80</a></div></div>
<div class="ttc" id="namespacetbb_1_1flow_html_a7bec4a3445fea3cd5974119730dea98fa76917a07891f92f41cfe7b357e1fa874"><div class="ttname"><a href="namespacetbb_1_1flow.html#a7bec4a3445fea3cd5974119730dea98fa76917a07891f92f41cfe7b357e1fa874">tbb::flow::serial</a></div><div class="ttdef"><b>Definition:</b> <a href="flow__graph_8h_source.html#l00088">flow_graph.h:88</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_a1f78f8cac44d71bb1f9e980bc2ddc65d"><div class="ttname"><a href="som__graph_8cpp.html#a1f78f8cac44d71bb1f9e980bc2ddc65d">last_update</a></div><div class="ttdeci">static search_result_type last_update</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00069">som_graph.cpp:69</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_a5fbb22abffc00845a74ad89b7eb0e94b"><div class="ttname"><a href="som__graph_8cpp.html#a5fbb22abffc00845a74ad89b7eb0e94b">wait_for_all_graphs</a></div><div class="ttdeci">void wait_for_all_graphs(int cIndex)</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00150">som_graph.cpp:150</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_a2ec5416ecbe67756ad26d860f8e61fbe"><div class="ttname"><a href="som__graph_8cpp.html#a2ec5416ecbe67756ad26d860f8e61fbe">restart_submaps</a></div><div class="ttdeci">void restart_submaps(int &amp;xval, int &amp;yval, double &amp;radius, int indx, SOM_element &amp;vector)</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00210">som_graph.cpp:210</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_a1ec46622a6ff23cae124e6d9465ab254"><div class="ttname"><a href="som__graph_8cpp.html#a1ec46622a6ff23cae124e6d9465ab254">radius_fraction</a></div><div class="ttdeci">static double radius_fraction</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00307">som_graph.cpp:307</a></div></div>
<div class="ttc" id="som_8h_html_a7cdd2608e2f29ee63285cd7c4a51d310"><div class="ttname"><a href="som_8h.html#a7cdd2608e2f29ee63285cd7c4a51d310">min_range</a></div><div class="ttdeci">DEFINE SOM_element min_range</div><div class="ttdef"><b>Definition:</b> <a href="som_8h_source.html#l00110">som.h:110</a></div></div>
<div class="ttc" id="som_8h_html_a7473a27543a23a8020ad7d518da0c9ab"><div class="ttname"><a href="som_8h.html#a7473a27543a23a8020ad7d518da0c9ab">radius_decay_rate</a></div><div class="ttdeci">DEFINE double radius_decay_rate</div><div class="ttdef"><b>Definition:</b> <a href="som_8h_source.html#l00062">som.h:62</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_a2d37cb2553682a378c0796186cd9b505"><div class="ttname"><a href="som__graph_8cpp.html#a2d37cb2553682a378c0796186cd9b505">cancel_submaps</a></div><div class="ttdeci">void cancel_submaps(int &amp;xval, int &amp;yval, double &amp;radius, int indx)</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00196">som_graph.cpp:196</a></div></div>
<div class="ttc" id="som_8h_html_a2f3b22b4e61a19afa6c2e45bedaeb62c"><div class="ttname"><a href="som_8h.html#a2f3b22b4e61a19afa6c2e45bedaeb62c">max_range</a></div><div class="ttdeci">DEFINE SOM_element max_range</div><div class="ttdef"><b>Definition:</b> <a href="som_8h_source.html#l00109">som.h:109</a></div></div>
<div class="ttc" id="classtbb_1_1tick__count_html"><div class="ttname"><a href="classtbb_1_1tick__count.html">tbb::tick_count</a></div><div class="ttdoc">Absolute timestamp. </div><div class="ttdef"><b>Definition:</b> <a href="tick__count_8h_source.html#l00038">tick_count.h:38</a></div></div>
<div class="ttc" id="som_8h_html_ab6bbfa436100819c81fd865cb0bdd55b"><div class="ttname"><a href="som_8h.html#ab6bbfa436100819c81fd865cb0bdd55b">max_radius</a></div><div class="ttdeci">DEFINE double max_radius</div><div class="ttdef"><b>Definition:</b> <a href="som_8h_source.html#l00064">som.h:64</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_a5754e5878c4a4653f2c3313aa0c9fdbe"><div class="ttname"><a href="som__graph_8cpp.html#a5754e5878c4a4653f2c3313aa0c9fdbe">search_node_vector_type</a></div><div class="ttdeci">std::vector&lt; search_node * &gt; search_node_vector_type</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00089">som_graph.cpp:89</a></div></div>
<div class="ttc" id="som_8h_html_abf29040eaa4190b2ece8bfba78874f65a52f66508417b1d9175ab91e972a54093"><div class="ttname"><a href="som_8h.html#abf29040eaa4190b2ece8bfba78874f65a52f66508417b1d9175ab91e972a54093">InitializeGradient</a></div><div class="ttdef"><b>Definition:</b> <a href="som_8h_source.html#l00072">som.h:72</a></div></div>
<div class="ttc" id="structutility_1_1thread__number__range_html"><div class="ttname"><a href="structutility_1_1thread__number__range.html">utility::thread_number_range</a></div><div class="ttdef"><b>Definition:</b> <a href="utility_8h_source.html#l00421">utility.h:421</a></div></div>
<div class="ttc" id="flow__graph_8h_html"><div class="ttname"><a href="flow__graph_8h.html">flow_graph.h</a></div><div class="ttdoc">The graph related classes and functions. </div></div>
<div class="ttc" id="classtbb_1_1task__scheduler__init_html"><div class="ttname"><a href="classtbb_1_1task__scheduler__init.html">tbb::task_scheduler_init</a></div><div class="ttdoc">Class delimiting the scope of task scheduler activity. </div><div class="ttdef"><b>Definition:</b> <a href="task__scheduler__init_8h_source.html#l00056">task_scheduler_init.h:56</a></div></div>
<div class="ttc" id="task__scheduler__init_8h_html"><div class="ttname"><a href="task__scheduler__init_8h.html">task_scheduler_init.h</a></div></div>
<div class="ttc" id="classBMU__search__body_html_a5da4722243abfedf13f203f21df65997"><div class="ttname"><a href="classBMU__search__body.html#a5da4722243abfedf13f203f21df65997">BMU_search_body::my_map</a></div><div class="ttdeci">SOMap &amp; my_map</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00072">som_graph.cpp:72</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_ae493181272fa9ab0f26074f3d55fa27a"><div class="ttname"><a href="som__graph_8cpp.html#ae493181272fa9ab0f26074f3d55fa27a">xsize</a></div><div class="ttdeci">static int xsize</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00060">som_graph.cpp:60</a></div></div>
<div class="ttc" id="structutility_1_1thread__number__range_html_a816791e01e98597ec1e5f6856e5bd540"><div class="ttname"><a href="structutility_1_1thread__number__range.html#a816791e01e98597ec1e5f6856e5bd540">utility::thread_number_range::first</a></div><div class="ttdeci">int first</div><div class="ttdef"><b>Definition:</b> <a href="utility_8h_source.html#l00423">utility.h:423</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="som__graph_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00310">som_graph.cpp:310</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_a0507a1193708ea4285fc35faf040050c"><div class="ttname"><a href="som__graph_8cpp.html#a0507a1193708ea4285fc35faf040050c">overlap</a></div><div class="ttdeci">bool overlap(int &amp;xval, int &amp;yval, search_result_type &amp;sr)</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00189">som_graph.cpp:189</a></div></div>
<div class="ttc" id="classSOMap_html_a19c3e6a13586e146ca859eea5f9fda08"><div class="ttname"><a href="classSOMap.html#a19c3e6a13586e146ca859eea5f9fda08">SOMap::initialize</a></div><div class="ttdeci">void initialize(InitializeType it, SOM_element &amp;max_range, SOM_element &amp;min_range)</div><div class="ttdef"><b>Definition:</b> <a href="som_8cpp_source.html#l00106">som.cpp:106</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_af1faccf35e9005eed4d1259fb2ae3f1b"><div class="ttname"><a href="som__graph_8cpp.html#af1faccf35e9005eed4d1259fb2ae3f1b">yRangeMax</a></div><div class="ttdeci">static int yRangeMax</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00067">som_graph.cpp:67</a></div></div>
<div class="ttc" id="som_8h_html"><div class="ttname"><a href="som_8h.html">som.h</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_a9fe42dea26d4f9c8da030ad751abe0c3"><div class="ttname"><a href="som__graph_8cpp.html#a9fe42dea26d4f9c8da030ad751abe0c3">SPECULATION_CNT</a></div><div class="ttdeci">#define SPECULATION_CNT</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00094">som_graph.cpp:94</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_a32af869bbcd0ede2149253f2db7bd0be"><div class="ttname"><a href="som__graph_8cpp.html#a32af869bbcd0ede2149253f2db7bd0be">xranges</a></div><div class="ttdeci">static int xranges</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00058">som_graph.cpp:58</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_ad1197662ffee752cab7ad2b523528278"><div class="ttname"><a href="som__graph_8cpp.html#ad1197662ffee752cab7ad2b523528278">graph_teach</a></div><div class="ttdeci">void graph_teach(SOMap &amp;map1, teaching_vector_type &amp;in)</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00259">som_graph.cpp:259</a></div></div>
<div class="ttc" id="namespaceutility_html_abe6afd617ae93bf41147e2d82c23eb07"><div class="ttname"><a href="namespaceutility.html#abe6afd617ae93bf41147e2d82c23eb07">utility::parse_cli_arguments</a></div><div class="ttdeci">void parse_cli_arguments(int argc, const char *argv[], utility::cli_argument_pack cli_pack)</div><div class="ttdef"><b>Definition:</b> <a href="utility_8h_source.html#l00501">utility.h:501</a></div></div>
<div class="ttc" id="som_8h_html_aaf4309fa3669886305579010786a9d9a"><div class="ttname"><a href="som_8h.html#aaf4309fa3669886305579010786a9d9a">teaching_vector_type</a></div><div class="ttdeci">std::vector&lt; SOM_element &gt; teaching_vector_type</div><div class="ttdef"><b>Definition:</b> <a href="som_8h_source.html#l00107">som.h:107</a></div></div>
<div class="ttc" id="structutility_1_1thread__number__range_html_af91460ff2be53ca1da029775ccd076a7"><div class="ttname"><a href="structutility_1_1thread__number__range.html#af91460ff2be53ca1da029775ccd076a7">utility::thread_number_range::last</a></div><div class="ttdeci">int last</div><div class="ttdef"><b>Definition:</b> <a href="utility_8h_source.html#l00424">utility.h:424</a></div></div>
<div class="ttc" id="som_8cpp_html_afaa2673447b95792a0e5b635cabe250f"><div class="ttname"><a href="som_8cpp.html#afaa2673447b95792a0e5b635cabe250f">remark_SOM_element</a></div><div class="ttdeci">void remark_SOM_element(const SOM_element &amp;s)</div><div class="ttdef"><b>Definition:</b> <a href="som_8cpp_source.html#l00051">som.cpp:51</a></div></div>
<div class="ttc" id="classtbb_1_1blocked__range2d_html"><div class="ttname"><a href="classtbb_1_1blocked__range2d.html">tbb::blocked_range2d&lt; int &gt;</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_a9fd160e78600bbd232c1f19085cd3c39"><div class="ttname"><a href="som__graph_8cpp.html#a9fd160e78600bbd232c1f19085cd3c39">search_node</a></div><div class="ttdeci">function_node&lt; SOM_element, search_result_type &gt; search_node</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00087">som_graph.cpp:87</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_aa67128caf3a7354984ecdcb5dadf712d"><div class="ttname"><a href="som__graph_8cpp.html#aa67128caf3a7354984ecdcb5dadf712d">build_BMU_graph</a></div><div class="ttdeci">void build_BMU_graph(SOMap &amp;map1)</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00108">som_graph.cpp:108</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_af13b06d6aed76fcc4b8502e3e84a6dcd"><div class="ttname"><a href="som__graph_8cpp.html#af13b06d6aed76fcc4b8502e3e84a6dcd">graph_BMU</a></div><div class="ttdeci">search_result_type graph_BMU(int indx)</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00227">som_graph.cpp:227</a></div></div>
<div class="ttc" id="ittnotify__static_8h_html_ae01354a6a694c51fb79588444a08cbee"><div class="ttname"><a href="ittnotify__static_8h.html#ae01354a6a694c51fb79588444a08cbee">p</a></div><div class="ttdeci">void const char const char int ITT_FORMAT __itt_group_sync p</div><div class="ttdef"><b>Definition:</b> <a href="ittnotify__static_8h_source.html#l00080">ittnotify_static.h:80</a></div></div>
<div class="ttc" id="ittnotify__static_8h_html_ac89988b817e773286215b17e80359ff3"><div class="ttname"><a href="ittnotify__static_8h.html#ac89988b817e773286215b17e80359ff3">int</a></div><div class="ttdeci">void const char const char int ITT_FORMAT __itt_group_sync x void const char ITT_FORMAT __itt_group_sync s void ITT_FORMAT __itt_group_sync p void ITT_FORMAT p void ITT_FORMAT p no args __itt_suppress_mode_t unsigned int void size_t ITT_FORMAT d void ITT_FORMAT p void ITT_FORMAT p __itt_model_site __itt_model_site_instance ITT_FORMAT p __itt_model_task __itt_model_task_instance ITT_FORMAT p void ITT_FORMAT p void ITT_FORMAT p void size_t ITT_FORMAT d void ITT_FORMAT p const wchar_t ITT_FORMAT s const char ITT_FORMAT s const char ITT_FORMAT s const char ITT_FORMAT s no args void ITT_FORMAT p size_t ITT_FORMAT d no args const wchar_t const wchar_t ITT_FORMAT s __itt_heap_function void size_t int ITT_FORMAT d __itt_heap_function void ITT_FORMAT p __itt_heap_function void void size_t int ITT_FORMAT d no args no args unsigned int ITT_FORMAT u const __itt_domain __itt_id ITT_FORMAT lu const __itt_domain __itt_id __itt_id __itt_string_handle ITT_FORMAT p const __itt_domain __itt_id ITT_FORMAT p const __itt_domain __itt_id __itt_timestamp __itt_timestamp ITT_FORMAT lu const __itt_domain __itt_id __itt_id __itt_string_handle ITT_FORMAT p const __itt_domain ITT_FORMAT p const __itt_domain __itt_string_handle unsigned long long ITT_FORMAT lu const __itt_domain __itt_id __itt_string_handle __itt_metadata_type size_t void ITT_FORMAT p const __itt_domain __itt_id __itt_string_handle const wchar_t size_t ITT_FORMAT lu const __itt_domain __itt_id __itt_relation __itt_id ITT_FORMAT p const wchar_t int ITT_FORMAT __itt_group_mark d int</div><div class="ttdef"><b>Definition:</b> <a href="ittnotify__static_8h_source.html#l00204">ittnotify_static.h:204</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_a4249b3ebda4de972d24aa1d6d940736f"><div class="ttname"><a href="som__graph_8cpp.html#a4249b3ebda4de972d24aa1d6d940736f">dont_speculate</a></div><div class="ttdeci">static bool dont_speculate</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00068">som_graph.cpp:68</a></div></div>
<div class="ttc" id="som_8h_html_a19c1f05ef6e47d9402405627974fb809"><div class="ttname"><a href="som_8h.html#a19c1f05ef6e47d9402405627974fb809">my_teaching</a></div><div class="ttdeci">DEFINE teaching_vector_type my_teaching</div><div class="ttdef"><b>Definition:</b> <a href="som_8h_source.html#l00118">som.h:118</a></div></div>
<div class="ttc" id="ittnotify__static_8h_html_a4a00e290d8b5952279115bbff9892198"><div class="ttname"><a href="ittnotify__static_8h.html#a4a00e290d8b5952279115bbff9892198">size</a></div><div class="ttdeci">void const char const char int ITT_FORMAT __itt_group_sync x void const char ITT_FORMAT __itt_group_sync s void ITT_FORMAT __itt_group_sync p void ITT_FORMAT p void ITT_FORMAT p no args __itt_suppress_mode_t unsigned int void size_t size</div><div class="ttdef"><b>Definition:</b> <a href="ittnotify__static_8h_source.html#l00098">ittnotify_static.h:98</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_a7ffc60a847109480ec0320f8f4f181fc"><div class="ttname"><a href="som__graph_8cpp.html#a7ffc60a847109480ec0320f8f4f181fc">g</a></div><div class="ttdeci">graph * g[SPECULATION_CNT]</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00096">som_graph.cpp:96</a></div></div>
<div class="ttc" id="EvtComplex_8hh_html_a6ffa44cf63579d02f7ad8266f5792805"><div class="ttname"><a href="EvtComplex_8hh.html#a6ffa44cf63579d02f7ad8266f5792805">exp</a></div><div class="ttdeci">EvtComplex exp(const EvtComplex &amp;c)</div><div class="ttdef"><b>Definition:</b> <a href="EvtComplex_8hh_source.html#l00264">EvtComplex.hh:264</a></div></div>
<div class="ttc" id="classSOM__element_html"><div class="ttname"><a href="classSOM__element.html">SOM_element</a></div><div class="ttdef"><b>Definition:</b> <a href="som_8h_source.html#l00081">som.h:81</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_a40d65054c8b42f7adf2389202f03d77d"><div class="ttname"><a href="som__graph_8cpp.html#a40d65054c8b42f7adf2389202f03d77d">function_node_execs</a></div><div class="ttdeci">std::vector&lt; int &gt; function_node_execs</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00065">som_graph.cpp:65</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_a02484ba0b62481bba766aeefbb717520"><div class="ttname"><a href="som__graph_8cpp.html#a02484ba0b62481bba766aeefbb717520">b_node</a></div><div class="ttdeci">broadcast_node&lt; SOM_element &gt; b_node</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00088">som_graph.cpp:88</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_a749a410cadcbe27cfb4afef68a41a0c7"><div class="ttname"><a href="som__graph_8cpp.html#a749a410cadcbe27cfb4afef68a41a0c7">send_to</a></div><div class="ttdeci">b_node * send_to[SPECULATION_CNT]</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00097">som_graph.cpp:97</a></div></div>
<div class="ttc" id="classSOMap_html_a8a7acff305596d58524faa4404424bb2"><div class="ttname"><a href="classSOMap.html#a8a7acff305596d58524faa4404424bb2">SOMap::epoch_update</a></div><div class="ttdeci">void epoch_update(SOM_element const &amp;s, int epoch, int min_x, int min_y, double radius, double learning_rate)</div><div class="ttdef"><b>Definition:</b> <a href="som_8h_source.html#l00138">som.h:138</a></div></div>
<div class="ttc" id="classSOMap_html_af77942b9164afaca599c67dcf9b0084f"><div class="ttname"><a href="classSOMap.html#af77942b9164afaca599c67dcf9b0084f">SOMap::size</a></div><div class="ttdeci">size_t size()</div><div class="ttdef"><b>Definition:</b> <a href="som_8h_source.html#l00133">som.h:133</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_ae900b2add8deca663438fb20de69acce"><div class="ttname"><a href="som__graph_8cpp.html#ae900b2add8deca663438fb20de69acce">q</a></div><div class="ttdeci">queue_node&lt; search_result_type &gt; * q[SPECULATION_CNT]</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00098">som_graph.cpp:98</a></div></div>
<div class="ttc" id="EvtComplex_8hh_html_af38e3c23adf905b08480ac93be90bb16"><div class="ttname"><a href="EvtComplex_8hh.html#af38e3c23adf905b08480ac93be90bb16">arg</a></div><div class="ttdeci">double arg(const EvtComplex &amp;c)</div><div class="ttdef"><b>Definition:</b> <a href="EvtComplex_8hh_source.html#l00236">EvtComplex.hh:236</a></div></div>
<div class="ttc" id="classBMU__search__body_html_aae6cb55a00bf061724f7fec1649792d7"><div class="ttname"><a href="classBMU__search__body.html#aae6cb55a00bf061724f7fec1649792d7">BMU_search_body::fn_tally</a></div><div class="ttdeci">int &amp; fn_tally</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00074">som_graph.cpp:74</a></div></div>
<div class="ttc" id="som_8h_html_a16eb97d90e5683b87599279f1c47db48"><div class="ttname"><a href="som_8h.html#a16eb97d90e5683b87599279f1c47db48">search_result_type</a></div><div class="ttdeci">tuple&lt; double, int, int &gt; search_result_type</div><div class="ttdef"><b>Definition:</b> <a href="som_8h_source.html#l00042">som.h:42</a></div></div>
<div class="ttc" id="polymain_8cpp_html_aff394e352c809421b815b9a8e40f3c64"><div class="ttname"><a href="polymain_8cpp.html#aff394e352c809421b815b9a8e40f3c64">indx</a></div><div class="ttdeci">#define indx(i, j)</div></div>
<div class="ttc" id="som__graph_8cpp_html_ac02b98124e6089e89a3bddb09e2cedb6"><div class="ttname"><a href="som__graph_8cpp.html#ac02b98124e6089e89a3bddb09e2cedb6">search_node_array_type</a></div><div class="ttdeci">std::vector&lt; search_node_vector_type &gt; search_node_array_type</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00090">som_graph.cpp:90</a></div></div>
<div class="ttc" id="classBMU__search__body_html_a75c91e1aa519083c5fa3c8f888cffbbd"><div class="ttname"><a href="classBMU__search__body.html#a75c91e1aa519083c5fa3c8f888cffbbd">BMU_search_body::BMU_search_body</a></div><div class="ttdeci">BMU_search_body(const BMU_search_body &amp;other)</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00077">som_graph.cpp:77</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_a07e79bb54f885c01c8419c4c99d8e5f9"><div class="ttname"><a href="som__graph_8cpp.html#a07e79bb54f885c01c8419c4c99d8e5f9">destroy_BMU_graph</a></div><div class="ttdeci">void destroy_BMU_graph()</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00159">som_graph.cpp:159</a></div></div>
<div class="ttc" id="classBMU__search__body_html_a6e20a53a9bd3eeece9a07c48c6736a60"><div class="ttname"><a href="classBMU__search__body.html#a6e20a53a9bd3eeece9a07c48c6736a60">BMU_search_body::operator()</a></div><div class="ttdeci">search_result_type operator()(const SOM_element s)</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00078">som_graph.cpp:78</a></div></div>
<div class="ttc" id="som__graph_8cpp_html_a842e1d2a64e9b3b014fc4993da3a769d"><div class="ttname"><a href="som__graph_8cpp.html#a842e1d2a64e9b3b014fc4993da3a769d">find_subrange_overlap</a></div><div class="ttdeci">void find_subrange_overlap(int const &amp;xval, int const &amp;yval, double const &amp;radius, int &amp;xlow, int &amp;xhigh, int &amp;ylow, int &amp;yhigh)</div><div class="ttdef"><b>Definition:</b> <a href="som__graph_8cpp_source.html#l00177">som_graph.cpp:177</a></div></div>
<div class="ttc" id="tick__count_8h_html"><div class="ttname"><a href="tick__count_8h.html">tick_count.h</a></div></div>
<div class="ttc" id="classSOMap_html_a541406964c0a17c8ae3d6e13457a524d"><div class="ttname"><a href="classSOMap.html#a541406964c0a17c8ae3d6e13457a524d">SOMap::BMU_range</a></div><div class="ttdeci">double BMU_range(const SOM_element &amp;s, int &amp;xval, int &amp;yval, subsquare_type &amp;r)</div><div class="ttdef"><b>Definition:</b> <a href="som_8cpp_source.html#l00123">som.cpp:123</a></div></div>
<div class="ttc" id="namespaceEvtCyclic3_html_af4cab885a5c1f8f7fadbe90eaf9964a4"><div class="ttname"><a href="namespaceEvtCyclic3.html#af4cab885a5c1f8f7fadbe90eaf9964a4">EvtCyclic3::other</a></div><div class="ttdeci">Index other(Index i, Index j)</div><div class="ttdef"><b>Definition:</b> <a href="EvtCyclic3_8cpp_source.html#l00121">EvtCyclic3.cpp:121</a></div></div>
<div class="ttc" id="blocked__range2d_8h_html"><div class="ttname"><a href="blocked__range2d_8h.html">blocked_range2d.h</a></div></div>
<div class="ttc" id="som_8cpp_html_a09587cd79c200644af779dd457110d4b"><div class="ttname"><a href="som_8cpp.html#a09587cd79c200644af779dd457110d4b">find_data_ranges</a></div><div class="ttdeci">void find_data_ranges(teaching_vector_type &amp;teaching, SOM_element &amp;max_range, SOM_element &amp;min_range)</div><div class="ttdef"><b>Definition:</b> <a href="som_8cpp_source.html#l00082">som.cpp:82</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Oct 8 2019 14:07:53 for ComPWA by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
